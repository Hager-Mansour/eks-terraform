- name: Add ArgoCD Helm repository
  shell: helm repo add argo https://argoproj.github.io/argo-helm || true
  changed_when: false

- name: Update Helm repositories
  command: helm repo update
  changed_when: false

- name: Install ArgoCD (with extended timeout)
  command: >
    helm upgrade --install argocd argo/argo-cd
    --namespace argocd
    --create-namespace
    --wait
    --timeout 10m
  changed_when: false
